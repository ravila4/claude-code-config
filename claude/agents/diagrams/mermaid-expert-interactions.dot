/**
 * mermaid-expert Agent Interaction Diagram
 *
 * Purpose: Visualizes the interaction patterns between mermaid-expert agent,
 *          the mermaid-diagrams skill, and collaborating agents in the ecosystem
 *
 * Author: graphviz-expert
 * Date: 2025-10-21
 * Version: 1.0
 *
 * Layout: dot (hierarchical) - Shows clear flow from architecture specs
 *         through diagram creation to documentation and feedback
 *
 * Conventions:
 *   - Rounded boxes: Agent nodes
 *   - Sharp boxes: Skill nodes
 *   - Bold edges: Primary workflow paths
 *   - Dashed edges: Feedback/query paths
 *   - Color coding by functional domain
 */

digraph mermaid_expert_interactions {
    // Graph attributes
    label = "mermaid-expert Agent Integration Pattern\nEcosystem Collaboration Workflow";
    labelloc = "t";
    fontname = "Arial";
    fontsize = 14;
    rankdir = TB;
    splines = ortho;
    nodesep = 0.8;
    ranksep = 1.2;

    // Default node and edge styling
    node [fontname="Arial", fontsize=11];
    edge [fontname="Arial", fontsize=9];

    // ========================================
    // SUBGRAPH: Core Visualization Components
    // ========================================
    subgraph cluster_core {
        label = "Core Visualization System";
        style = filled;
        fillcolor = "#e3f2fd";
        color = "#1976d2";
        penwidth = 2;

        // Central agent node
        mermaid_expert [
            label = "mermaid-expert\n(Agent)",
            shape = box,
            style = "rounded,filled",
            fillcolor = "#2196f3",
            fontcolor = white,
            penwidth = 3,
            width = 2.5,
            height = 1
        ];

        // Technical skill node
        mermaid_diagrams [
            label = "mermaid-diagrams\n(Skill)\n\n• Sequence diagrams\n• State diagrams\n• Flowcharts\n• Entity relationships",
            shape = box,
            style = filled,
            fillcolor = "#fff9c4",
            color = "#f57f17",
            penwidth = 2,
            width = 2.5
        ];
    }

    // ========================================
    // SUBGRAPH: Input Provider Agents
    // ========================================
    subgraph cluster_input {
        label = "Specification Providers";
        style = filled;
        fillcolor = "#f3e5f5";
        color = "#7b1fa2";

        software_architect [
            label = "software-architect\n(Agent)\n\nProvides:\n• Architecture specs\n• System designs\n• Component relationships",
            shape = box,
            style = "rounded,filled",
            fillcolor = "#9c27b0",
            fontcolor = white,
            width = 2.8
        ];

        obsidian_vault [
            label = "obsidian-vault-manager\n(Agent)\n\nRequests:\n• Documentation diagrams\n• Concept visualizations\n• Knowledge graphs",
            shape = box,
            style = "rounded,filled",
            fillcolor = "#9c27b0",
            fontcolor = white,
            width = 2.8
        ];
    }

    // ========================================
    // SUBGRAPH: Quality Assurance
    // ========================================
    subgraph cluster_quality {
        label = "Quality Assurance & Feedback";
        style = filled;
        fillcolor = "#e8f5e9";
        color = "#388e3c";

        visual_design_critic [
            label = "visual-design-critic\n(Agent)\n\nReviews:\n• Diagram clarity\n• Visual hierarchy\n• Design principles\n• Accessibility",
            shape = box,
            style = "rounded,filled",
            fillcolor = "#4caf50",
            fontcolor = white,
            width = 2.8
        ];
    }

    // ========================================
    // PRIMARY WORKFLOW EDGES
    // ========================================

    // Core skill invocation
    mermaid_expert -> mermaid_diagrams [
        label = "USES\n(invokes for technical\ndiagram generation)",
        style = bold,
        color = "#1976d2",
        penwidth = 2.5,
        arrowsize = 1.2
    ];

    // Input flows to mermaid-expert
    software_architect -> mermaid_expert [
        label = "PROVIDES SPECS\n(architecture designs,\nsystem components)",
        style = bold,
        color = "#7b1fa2",
        penwidth = 2,
        arrowsize = 1.2
    ];

    obsidian_vault -> mermaid_expert [
        label = "REQUESTS DIAGRAMS\n(for documentation,\nknowledge base)",
        style = bold,
        color = "#7b1fa2",
        penwidth = 2,
        arrowsize = 1.2
    ];

    // Output flows from mermaid-expert
    mermaid_expert -> visual_design_critic [
        label = "REQUESTS FEEDBACK\n(after diagram creation,\nfor design improvement)",
        style = bold,
        color = "#388e3c",
        penwidth = 2,
        arrowsize = 1.2
    ];

    visual_design_critic -> mermaid_expert [
        label = "PROVIDES CRITIQUE\n(clarity, accessibility,\nvisual hierarchy)",
        style = dashed,
        color = "#388e3c",
        penwidth = 1.5,
        arrowsize = 1
    ];

    mermaid_expert -> obsidian_vault [
        label = "DELIVERS DIAGRAMS\n(finalized visualizations\nfor documentation)",
        style = bold,
        color = "#7b1fa2",
        penwidth = 2,
        arrowsize = 1.2
    ];

    // ========================================
    // LEGEND
    // ========================================
    subgraph cluster_legend {
        label = "Legend";
        style = filled;
        fillcolor = white;
        color = black;

        legend_table [
            label = <<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4">
                <TR>
                    <TD BGCOLOR="#2196f3"><FONT COLOR="white">Agent Node</FONT></TD>
                    <TD>Autonomous agent with specialized capabilities</TD>
                </TR>
                <TR>
                    <TD BGCOLOR="#fff9c4">Skill Node</TD>
                    <TD>Technical capability/tool invoked by agents</TD>
                </TR>
                <TR>
                    <TD COLSPAN="2">─────  Primary Workflow (bold)</TD>
                </TR>
                <TR>
                    <TD COLSPAN="2">- - - -  Feedback/Query Path (dashed)</TD>
                </TR>
                <TR>
                    <TD COLSPAN="2">· · · · ·  Knowledge Exchange (dotted)</TD>
                </TR>
            </TABLE>>,
            shape = plaintext
        ];
    }
}
